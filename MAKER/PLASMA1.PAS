Program MakerPlasma1;

Uses Adele,Systex,Systems,Video;

Const
 D:Palette256RGB=(
  (R:0 shl 2;G:0 shl 2;B:0 shl 2),
  (R:0 shl 2;G:0 shl 2;B:63 shl 2),
  (R:0 shl 2;G:1 shl 2;B:62 shl 2),
  (R:0 shl 2;G:2 shl 2;B:61 shl 2),
  (R:0 shl 2;G:2 shl 2;B:60 shl 2),
  (R:0 shl 2;G:3 shl 2;B:60 shl 2),
  (R:0 shl 2;G:4 shl 2;B:59 shl 2),
  (R:0 shl 2;G:5 shl 2;B:58 shl 2),
  (R:0 shl 2;G:5 shl 2;B:57 shl 2),
  (R:0 shl 2;G:6 shl 2;B:57 shl 2),
  (R:0 shl 2;G:7 shl 2;B:56 shl 2),
  (R:0 shl 2;G:8 shl 2;B:55 shl 2),
  (R:0 shl 2;G:8 shl 2;B:54 shl 2),
  (R:0 shl 2;G:9 shl 2;B:54 shl 2),
  (R:0 shl 2;G:10 shl 2;B:53 shl 2),
  (R:0 shl 2;G:11 shl 2;B:52 shl 2),
  (R:0 shl 2;G:11 shl 2;B:51 shl 2),
  (R:0 shl 2;G:12 shl 2;B:51 shl 2),
  (R:0 shl 2;G:13 shl 2;B:50 shl 2),
  (R:0 shl 2;G:14 shl 2;B:49 shl 2),
  (R:0 shl 2;G:14 shl 2;B:48 shl 2),
  (R:0 shl 2;G:15 shl 2;B:48 shl 2),
  (R:0 shl 2;G:16 shl 2;B:47 shl 2),
  (R:0 shl 2;G:17 shl 2;B:46 shl 2),
  (R:0 shl 2;G:17 shl 2;B:45 shl 2),
  (R:0 shl 2;G:18 shl 2;B:45 shl 2),
  (R:0 shl 2;G:19 shl 2;B:44 shl 2),
  (R:0 shl 2;G:20 shl 2;B:43 shl 2),
  (R:0 shl 2;G:20 shl 2;B:42 shl 2),
  (R:0 shl 2;G:21 shl 2;B:42 shl 2),
  (R:0 shl 2;G:22 shl 2;B:41 shl 2),
  (R:0 shl 2;G:22 shl 2;B:40 shl 2),
  (R:0 shl 2;G:23 shl 2;B:40 shl 2),
  (R:0 shl 2;G:24 shl 2;B:39 shl 2),
  (R:0 shl 2;G:25 shl 2;B:38 shl 2),
  (R:0 shl 2;G:25 shl 2;B:37 shl 2),
  (R:0 shl 2;G:26 shl 2;B:37 shl 2),
  (R:0 shl 2;G:27 shl 2;B:36 shl 2),
  (R:0 shl 2;G:28 shl 2;B:35 shl 2),
  (R:0 shl 2;G:28 shl 2;B:34 shl 2),
  (R:0 shl 2;G:29 shl 2;B:34 shl 2),
  (R:0 shl 2;G:30 shl 2;B:33 shl 2),
  (R:0 shl 2;G:31 shl 2;B:32 shl 2),
  (R:0 shl 2;G:31 shl 2;B:31 shl 2),
  (R:0 shl 2;G:32 shl 2;B:31 shl 2),
  (R:0 shl 2;G:33 shl 2;B:30 shl 2),
  (R:0 shl 2;G:34 shl 2;B:29 shl 2),
  (R:0 shl 2;G:34 shl 2;B:28 shl 2),
  (R:0 shl 2;G:35 shl 2;B:28 shl 2),
  (R:0 shl 2;G:36 shl 2;B:27 shl 2),
  (R:0 shl 2;G:37 shl 2;B:26 shl 2),
  (R:0 shl 2;G:37 shl 2;B:25 shl 2),
  (R:0 shl 2;G:38 shl 2;B:25 shl 2),
  (R:0 shl 2;G:39 shl 2;B:24 shl 2),
  (R:0 shl 2;G:40 shl 2;B:23 shl 2),
  (R:0 shl 2;G:40 shl 2;B:22 shl 2),
  (R:0 shl 2;G:41 shl 2;B:22 shl 2),
  (R:0 shl 2;G:42 shl 2;B:21 shl 2),
  (R:0 shl 2;G:42 shl 2;B:20 shl 2),
  (R:0 shl 2;G:43 shl 2;B:20 shl 2),
  (R:0 shl 2;G:44 shl 2;B:19 shl 2),
  (R:0 shl 2;G:45 shl 2;B:18 shl 2),
  (R:0 shl 2;G:45 shl 2;B:17 shl 2),
  (R:0 shl 2;G:46 shl 2;B:17 shl 2),
  (R:0 shl 2;G:47 shl 2;B:16 shl 2),
  (R:0 shl 2;G:48 shl 2;B:15 shl 2),
  (R:0 shl 2;G:48 shl 2;B:14 shl 2),
  (R:0 shl 2;G:49 shl 2;B:14 shl 2),
  (R:0 shl 2;G:50 shl 2;B:13 shl 2),
  (R:0 shl 2;G:51 shl 2;B:12 shl 2),
  (R:0 shl 2;G:51 shl 2;B:11 shl 2),
  (R:0 shl 2;G:52 shl 2;B:11 shl 2),
  (R:0 shl 2;G:53 shl 2;B:10 shl 2),
  (R:0 shl 2;G:54 shl 2;B:9 shl 2),
  (R:0 shl 2;G:54 shl 2;B:8 shl 2),
  (R:0 shl 2;G:55 shl 2;B:8 shl 2),
  (R:0 shl 2;G:56 shl 2;B:7 shl 2),
  (R:0 shl 2;G:57 shl 2;B:6 shl 2),
  (R:0 shl 2;G:57 shl 2;B:5 shl 2),
  (R:0 shl 2;G:58 shl 2;B:5 shl 2),
  (R:0 shl 2;G:59 shl 2;B:4 shl 2),
  (R:0 shl 2;G:60 shl 2;B:3 shl 2),
  (R:0 shl 2;G:60 shl 2;B:2 shl 2),
  (R:0 shl 2;G:61 shl 2;B:2 shl 2),
  (R:0 shl 2;G:62 shl 2;B:1 shl 2),
  (R:0 shl 2;G:63 shl 2;B:0 shl 2),
  (R:0 shl 2;G:63 shl 2;B:0 shl 2),
  (R:1 shl 2;G:62 shl 2;B:0 shl 2),
  (R:2 shl 2;G:61 shl 2;B:0 shl 2),
  (R:2 shl 2;G:60 shl 2;B:0 shl 2),
  (R:3 shl 2;G:60 shl 2;B:0 shl 2),
  (R:4 shl 2;G:59 shl 2;B:0 shl 2),
  (R:5 shl 2;G:58 shl 2;B:0 shl 2),
  (R:5 shl 2;G:57 shl 2;B:0 shl 2),
  (R:6 shl 2;G:57 shl 2;B:0 shl 2),
  (R:7 shl 2;G:56 shl 2;B:0 shl 2),
  (R:8 shl 2;G:55 shl 2;B:0 shl 2),
  (R:8 shl 2;G:54 shl 2;B:0 shl 2),
  (R:9 shl 2;G:54 shl 2;B:0 shl 2),
  (R:10 shl 2;G:53 shl 2;B:0 shl 2),
  (R:11 shl 2;G:52 shl 2;B:0 shl 2),
  (R:11 shl 2;G:51 shl 2;B:0 shl 2),
  (R:12 shl 2;G:51 shl 2;B:0 shl 2),
  (R:13 shl 2;G:50 shl 2;B:0 shl 2),
  (R:14 shl 2;G:49 shl 2;B:0 shl 2),
  (R:14 shl 2;G:48 shl 2;B:0 shl 2),
  (R:15 shl 2;G:48 shl 2;B:0 shl 2),
  (R:16 shl 2;G:47 shl 2;B:0 shl 2),
  (R:17 shl 2;G:46 shl 2;B:0 shl 2),
  (R:17 shl 2;G:45 shl 2;B:0 shl 2),
  (R:18 shl 2;G:45 shl 2;B:0 shl 2),
  (R:19 shl 2;G:44 shl 2;B:0 shl 2),
  (R:20 shl 2;G:43 shl 2;B:0 shl 2),
  (R:20 shl 2;G:42 shl 2;B:0 shl 2),
  (R:21 shl 2;G:42 shl 2;B:0 shl 2),
  (R:22 shl 2;G:41 shl 2;B:0 shl 2),
  (R:22 shl 2;G:40 shl 2;B:0 shl 2),
  (R:23 shl 2;G:40 shl 2;B:0 shl 2),
  (R:24 shl 2;G:39 shl 2;B:0 shl 2),
  (R:25 shl 2;G:38 shl 2;B:0 shl 2),
  (R:25 shl 2;G:37 shl 2;B:0 shl 2),
  (R:26 shl 2;G:37 shl 2;B:0 shl 2),
  (R:27 shl 2;G:36 shl 2;B:0 shl 2),
  (R:28 shl 2;G:35 shl 2;B:0 shl 2),
  (R:28 shl 2;G:34 shl 2;B:0 shl 2),
  (R:29 shl 2;G:34 shl 2;B:0 shl 2),
  (R:30 shl 2;G:33 shl 2;B:0 shl 2),
  (R:31 shl 2;G:32 shl 2;B:0 shl 2),
  (R:31 shl 2;G:31 shl 2;B:0 shl 2),
  (R:32 shl 2;G:31 shl 2;B:0 shl 2),
  (R:33 shl 2;G:30 shl 2;B:0 shl 2),
  (R:34 shl 2;G:29 shl 2;B:0 shl 2),
  (R:34 shl 2;G:28 shl 2;B:0 shl 2),
  (R:35 shl 2;G:28 shl 2;B:0 shl 2),
  (R:36 shl 2;G:27 shl 2;B:0 shl 2),
  (R:37 shl 2;G:26 shl 2;B:0 shl 2),
  (R:37 shl 2;G:25 shl 2;B:0 shl 2),
  (R:38 shl 2;G:25 shl 2;B:0 shl 2),
  (R:39 shl 2;G:24 shl 2;B:0 shl 2),
  (R:40 shl 2;G:23 shl 2;B:0 shl 2),
  (R:40 shl 2;G:22 shl 2;B:0 shl 2),
  (R:41 shl 2;G:22 shl 2;B:0 shl 2),
  (R:42 shl 2;G:21 shl 2;B:0 shl 2),
  (R:42 shl 2;G:20 shl 2;B:0 shl 2),
  (R:43 shl 2;G:20 shl 2;B:0 shl 2),
  (R:44 shl 2;G:19 shl 2;B:0 shl 2),
  (R:45 shl 2;G:18 shl 2;B:0 shl 2),
  (R:45 shl 2;G:17 shl 2;B:0 shl 2),
  (R:46 shl 2;G:17 shl 2;B:0 shl 2),
  (R:47 shl 2;G:16 shl 2;B:0 shl 2),
  (R:48 shl 2;G:15 shl 2;B:0 shl 2),
  (R:48 shl 2;G:14 shl 2;B:0 shl 2),
  (R:49 shl 2;G:14 shl 2;B:0 shl 2),
  (R:50 shl 2;G:13 shl 2;B:0 shl 2),
  (R:51 shl 2;G:12 shl 2;B:0 shl 2),
  (R:51 shl 2;G:11 shl 2;B:0 shl 2),
  (R:52 shl 2;G:11 shl 2;B:0 shl 2),
  (R:53 shl 2;G:10 shl 2;B:0 shl 2),
  (R:54 shl 2;G:9 shl 2;B:0 shl 2),
  (R:54 shl 2;G:8 shl 2;B:0 shl 2),
  (R:55 shl 2;G:8 shl 2;B:0 shl 2),
  (R:56 shl 2;G:7 shl 2;B:0 shl 2),
  (R:57 shl 2;G:6 shl 2;B:0 shl 2),
  (R:57 shl 2;G:5 shl 2;B:0 shl 2),
  (R:58 shl 2;G:5 shl 2;B:0 shl 2),
  (R:59 shl 2;G:4 shl 2;B:0 shl 2),
  (R:60 shl 2;G:3 shl 2;B:0 shl 2),
  (R:60 shl 2;G:2 shl 2;B:0 shl 2),
  (R:61 shl 2;G:2 shl 2;B:0 shl 2),
  (R:62 shl 2;G:1 shl 2;B:0 shl 2),
  (R:63 shl 2;G:0 shl 2;B:0 shl 2),
  (R:63 shl 2;G:0 shl 2;B:0 shl 2),
  (R:62 shl 2;G:0 shl 2;B:1 shl 2),
  (R:61 shl 2;G:0 shl 2;B:2 shl 2),
  (R:60 shl 2;G:0 shl 2;B:2 shl 2),
  (R:60 shl 2;G:0 shl 2;B:3 shl 2),
  (R:59 shl 2;G:0 shl 2;B:4 shl 2),
  (R:58 shl 2;G:0 shl 2;B:5 shl 2),
  (R:57 shl 2;G:0 shl 2;B:5 shl 2),
  (R:57 shl 2;G:0 shl 2;B:6 shl 2),
  (R:56 shl 2;G:0 shl 2;B:7 shl 2),
  (R:55 shl 2;G:0 shl 2;B:8 shl 2),
  (R:54 shl 2;G:0 shl 2;B:8 shl 2),
  (R:54 shl 2;G:0 shl 2;B:9 shl 2),
  (R:53 shl 2;G:0 shl 2;B:10 shl 2),
  (R:52 shl 2;G:0 shl 2;B:11 shl 2),
  (R:51 shl 2;G:0 shl 2;B:11 shl 2),
  (R:51 shl 2;G:0 shl 2;B:12 shl 2),
  (R:50 shl 2;G:0 shl 2;B:13 shl 2),
  (R:49 shl 2;G:0 shl 2;B:14 shl 2),
  (R:48 shl 2;G:0 shl 2;B:14 shl 2),
  (R:48 shl 2;G:0 shl 2;B:15 shl 2),
  (R:47 shl 2;G:0 shl 2;B:16 shl 2),
  (R:46 shl 2;G:0 shl 2;B:17 shl 2),
  (R:45 shl 2;G:0 shl 2;B:17 shl 2),
  (R:45 shl 2;G:0 shl 2;B:18 shl 2),
  (R:44 shl 2;G:0 shl 2;B:19 shl 2),
  (R:43 shl 2;G:0 shl 2;B:20 shl 2),
  (R:42 shl 2;G:0 shl 2;B:20 shl 2),
  (R:42 shl 2;G:0 shl 2;B:21 shl 2),
  (R:41 shl 2;G:0 shl 2;B:22 shl 2),
  (R:40 shl 2;G:0 shl 2;B:22 shl 2),
  (R:40 shl 2;G:0 shl 2;B:23 shl 2),
  (R:39 shl 2;G:0 shl 2;B:24 shl 2),
  (R:38 shl 2;G:0 shl 2;B:25 shl 2),
  (R:37 shl 2;G:0 shl 2;B:25 shl 2),
  (R:37 shl 2;G:0 shl 2;B:26 shl 2),
  (R:36 shl 2;G:0 shl 2;B:27 shl 2),
  (R:35 shl 2;G:0 shl 2;B:28 shl 2),
  (R:34 shl 2;G:0 shl 2;B:28 shl 2),
  (R:34 shl 2;G:0 shl 2;B:29 shl 2),
  (R:33 shl 2;G:0 shl 2;B:30 shl 2),
  (R:32 shl 2;G:0 shl 2;B:31 shl 2),
  (R:31 shl 2;G:0 shl 2;B:31 shl 2),
  (R:31 shl 2;G:0 shl 2;B:32 shl 2),
  (R:30 shl 2;G:0 shl 2;B:33 shl 2),
  (R:29 shl 2;G:0 shl 2;B:34 shl 2),
  (R:28 shl 2;G:0 shl 2;B:34 shl 2),
  (R:28 shl 2;G:0 shl 2;B:35 shl 2),
  (R:27 shl 2;G:0 shl 2;B:36 shl 2),
  (R:26 shl 2;G:0 shl 2;B:37 shl 2),
  (R:25 shl 2;G:0 shl 2;B:37 shl 2),
  (R:25 shl 2;G:0 shl 2;B:38 shl 2),
  (R:24 shl 2;G:0 shl 2;B:39 shl 2),
  (R:23 shl 2;G:0 shl 2;B:40 shl 2),
  (R:22 shl 2;G:0 shl 2;B:40 shl 2),
  (R:22 shl 2;G:0 shl 2;B:41 shl 2),
  (R:21 shl 2;G:0 shl 2;B:42 shl 2),
  (R:20 shl 2;G:0 shl 2;B:42 shl 2),
  (R:20 shl 2;G:0 shl 2;B:43 shl 2),
  (R:19 shl 2;G:0 shl 2;B:44 shl 2),
  (R:18 shl 2;G:0 shl 2;B:45 shl 2),
  (R:17 shl 2;G:0 shl 2;B:45 shl 2),
  (R:17 shl 2;G:0 shl 2;B:46 shl 2),
  (R:16 shl 2;G:0 shl 2;B:47 shl 2),
  (R:15 shl 2;G:0 shl 2;B:48 shl 2),
  (R:14 shl 2;G:0 shl 2;B:48 shl 2),
  (R:14 shl 2;G:0 shl 2;B:49 shl 2),
  (R:13 shl 2;G:0 shl 2;B:50 shl 2),
  (R:12 shl 2;G:0 shl 2;B:51 shl 2),
  (R:11 shl 2;G:0 shl 2;B:51 shl 2),
  (R:11 shl 2;G:0 shl 2;B:52 shl 2),
  (R:10 shl 2;G:0 shl 2;B:53 shl 2),
  (R:9 shl 2;G:0 shl 2;B:54 shl 2),
  (R:8 shl 2;G:0 shl 2;B:54 shl 2),
  (R:8 shl 2;G:0 shl 2;B:55 shl 2),
  (R:7 shl 2;G:0 shl 2;B:56 shl 2),
  (R:6 shl 2;G:0 shl 2;B:57 shl 2),
  (R:5 shl 2;G:0 shl 2;B:57 shl 2),
  (R:5 shl 2;G:0 shl 2;B:58 shl 2),
  (R:4 shl 2;G:0 shl 2;B:59 shl 2),
  (R:3 shl 2;G:0 shl 2;B:60 shl 2),
  (R:2 shl 2;G:0 shl 2;B:60 shl 2),
  (R:2 shl 2;G:0 shl 2;B:61 shl 2),
  (R:1 shl 2;G:0 shl 2;B:62 shl 2),
  (R:0 shl 2;G:0 shl 2;B:63 shl 2)
 );

{ Les valeurs possible de plasma sont:
   1.00 >= Träs "smooth"
   6.00 <= Träs "rough" }

Procedure NewKr(xa,ya,x,y,xb,yb:Integer);
Const
 RoughNess=2.25;
Var
 Kr:Integer;
Begin
 Kr:=Abs(xa-xb)+Abs(ya-yb);
 Kr:=((GetPixel(xa,ya)+GetPixel(xb,yb))shr 1)+Round((Random-0.5)*Kr*Roughness);
 If Kr<1Then Kr:=1 else
 If Kr>255Then Kr:=255;
 If GetPixel(X,Y)=0Then SetPixel(x,y,Kr);
End;

Procedure Iterate(x1,y1,x2,y2:Int);Var x,y,Kr:Int;Begin
 If Not((x2-x1<2)and(y2-y1<2))Then Begin
  x:=(x1+x2)shr 1;y:=(y1+y2)shr 1;
  NewKr(x1,y1,x ,y1,x2,y1);
  NewKr(x2,y1,x2,y, x2,y2);
  NewKr(x1,y2,x, y2,x2,y2);
  NewKr(x1,y1,x1,y, x1,y2);
  Kr:=(getpixel(x1,y1)+getpixel(x2,y1)+getpixel(x2,y2)+getpixel(x1,y2)+2)shr 2;
  SetPixel(x, y, Kr);
  Iterate(x1,y1,x,y);
  Iterate(x,y1,x2,y);
  Iterate(x,y,x2,y2);
  Iterate(x1,y,x,y2);
 End;
End;

Procedure SaveImage;Var Handle:Hdl;I:Byte;Begin
 Handle:=NewNBak('\SOURCE\CHANTAL\RESOURCE\INTRO\PLASMA1.GFX');
 If(Handle<>errHdl)Then Begin
  _SetAbsRec(Handle,0,64000,Mem[_A000:0]);
  _SetAbsRec(Handle,64000,768,D);
  FileClose(Handle)
 End;
End;

BEGIN
 InitSystems(suIsabel);
 SetVideoMode(vmGrf320x200c256);
 SetPalRGB(D,0,256);
 Randomize;
 Iterate(0,0,NmXPixels-1,NmYPixels-1);
 SaveImage;
END.
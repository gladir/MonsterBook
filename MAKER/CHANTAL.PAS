Program Chantal;

Uses Adele,Systex,Memories,Systems,SysPlus,ResTex,ResServD,ResSaveD;

Var
 Q:DataSet;
 Code:Word;

Procedure OnStatusCompiler(Var X;Var Context;Line:LongInt);
Var
 Q:DataSet Absolute X;
Begin
 If Q.ErrCode>0Then Begin
  WriteLn('Erreur … la ligne ',Line,': ',HexWord2Str(Q.ErrCode));
  WriteLn(PChar(Q.PC));
  WriteLn(Spc(Q.ReadX),'^');
  Q.ErrCode:=0;
 End;
End;

Procedure Add(Const Source,Dest:String);
Var
 L:ArrayList;
Begin
 WriteLn('Traitement du Source: ',Source);
 DBOpenServerName(Q,Dest);
 ALLoadFileASCII(L,Source);
 If Not DBCreateWithSQL(Q,L,errHdl)Then WriteLn('Erreur pendant la compilation');
 ALDone(L);
End;

Procedure AddFile(Const Source,Dest:String);
Var
 Handle:Hdl;
 L:ArrayList;
Begin
 FillClr(L,SizeOf(L));
 Handle:=FileOpen(Source,fmRead);
 If(Handle=errHdl)Then WriteLn('Fichier introuvable: '+Source)
  Else
 Begin
  WriteLn('Traitement du Source: ',Source);
  DBOpenServerName(Q,Dest);
  If Not DBCreateWithSQL(Q,L,Handle)Then WriteLn('Erreur pendant la compilation');
  FileClose(Handle);
 End;
End;

BEGIN
 InitSystems(suIsabel);
 If DeleteFile('\MALTE\DATA\CHANTAL.DAT')<>0Then Begin
  WriteLn('Impossible d''effacer l''ancienne base de donn‚es CHANTAL');
 End;
 DBInitServer(Q,'\MALTE\DATA\CHANTAL.DAT');
 Q.OnStatusCompiler:=OnStatusCompiler;
 DBLogin(Q,'ADMINISTRATOR','SYSTEM');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\COUNTRY.SQL','CHANTAL:/Country/Country.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\PAYS.SQL','CHANTAL:/Country/Pays.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\ALLEMAGNE.SQL','CHANTAL:/Country/Allemagne.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\ANGLETER.SQL','CHANTAL:/Country/Angleterre.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\PROVINCE.SQL','CHANTAL:/Country/Canada.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\CHINE.SQL','CHANTAL:/Country/Chine.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\ETAT.SQL','CHANTAL:/Country/EtatsUnis.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\URSS.SQL','CHANTAL:/Country/URSS.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\ANSI2ASC.SQL','CHANTAL:/Country/Ansi2ASCII.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\ASC2ANSI.SQL','CHANTAL:/Country/ASCII2Ansi.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COUNTRY\4372ANSI.SQL','CHANTAL:/Country/4372ToAnsi.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\ASM\6502.SQL','CHANTAL:/CPU/Motorola/Inline6502.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\ASM\8080.SQL','CHANTAL:/CPU/Intel/Inline8080.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\ASM\80x86.SQL','CHANTAL:/CPU/Intel/Inline8086.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\ASM\IFCOND.SQL','CHANTAL:/CPU/Intel/ConditionSi.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\ASM\INSTNAME.SQL','CHANTAL:/CPU/Intel/Instr.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\ASM\MAINWORD.SQL','CHANTAL:/CPU/Intel/MotsReserves.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\ASM\REGISTER.SQL','CHANTAL:/CPU/Intel/Registre.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\EDITOR\RTF.SQL','CHANTAL:/Texte/Format/RTF.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\EDITOR\ASCIHTML.SQL','CHANTAL:/Texte/Format/ASCII2HTML.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\EDITOR\HTMLASCI.SQL','CHANTAL:/Texte/Format/HTML2ASCII.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\EDITOR\ASCIIRTF.SQL','CHANTAL:/Texte/Format/ASCII2RTF.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\VIDCOMPU.SQL','CHANTAL:/Materiel/VIDComputer.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\IDMONITO.SQL','CHANTAL:/Materiel/IDMoniteur.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\IDVIDEO.SQL','CHANTAL:/Materiel/IDVideo.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\CPUMODEL.SQL','CHANTAL:/Materiel/CPUModele.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\PRINTERS.SQL','CHANTAL:/Materiel/Imprimante.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\PCICLASS.SQL','CHANTAL:/Materiel/PCI/Classe.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\PCISUBCL.SQL','CHANTAL:/Materiel/PCI/SousClasse.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\PCIVDI.SQL','CHANTAL:/Materiel/PCI/VDI.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\PCIDID.SQL','CHANTAL:/Materiel/PCI/DID.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\SCSIBIOS.SQL','CHANTAL:/Materiel/SCSI/BIOSSignature.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\POPMENU.SQL','CHANTAL:/Materiel/Souris/PopMenu.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\RAMBIOS.SQL','CHANTAL:/Materiel/RamBios.Dat');
 AddFile('\SOURCE\CHANTAL\RESOURCE\HARDWARE\KBDMODEL.SQL','CHANTAL:/Materiel/Clavier/Modele.Dat');
 AddFile('\SOURCE\CHANTAL\RESOURCE\HARDWARE\KBDTABLE.SQL','CHANTAL:/Materiel/Clavier/TableBIOS.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\INTR.SQL','CHANTAL:/Materiel/Interruption.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\INTRMULT.SQL','CHANTAL:/Materiel/InterruptionMultiplex.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\COLORCLS.SQL','CHANTAL:/Materiel/Video/CouleurClassique.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\DISQUE\PARTITIO.SQL','CHANTAL:/Disque/Partition.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\FICHIER\EXTENSIO.SQL','CHANTAL:/Fichier/Entete/Extensior.Dat');
 AddFile('\SOURCE\CHANTAL\RESOURCE\FICHIER\INDEX.SQL','CHANTAL:/Fichier/Index.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\FICHIER\IMAGES.SQL','CHANTAL:/Fichier/Images/Format.Dat');
{ Add('\SOURCE\CHANTAL\RESOURCE\MATH\CRC32.SQL','CHANTAL:/Math/Systeme/CRC32.Dat');}
 Add('\SOURCE\CHANTAL\RESOURCE\SYSTEM\CALC.SQL','CHANTAL:/Math/Calc.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\MATH\CONVERS.SQL','CHANTAL:/Math/Convers.Dat');
 AddFile('\SOURCE\CHANTAL\RESOURCE\COMPILER\BASIC\INSTR.SQL','CHANTAL:/Compilateur/Basic/Instruction.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\BASIC\FONCTION.SQL','CHANTAL:/Compilateur/Basic/Fonction.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\BASIC\FONCSTR.SQL','CHANTAL:/Compilateur/Basic/FonctionString.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\BASIC\MAINWORD.SQL','CHANTAL:/Compilateur/Basic/MotsReserves.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\BASIC\GWBASIC.SQL','CHANTAL:/Compilateur/Basic/GWBasic.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\C\MAINWORD.SQL','CHANTAL:/Compilateur/C/MotsReserves.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\COBOL\MAINWORD.SQL','CHANTAL:/Compilateur/Cobol/MotsReserves.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\CRLL\INSTR.SQL','CHANTAL:/Compilateur/CRLL/Instruction.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\EUPHORIA.SQL','CHANTAL:/Compilateur/Euphoria/MotsReserves.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\FORTRAN.SQL','CHANTAL:/Compilateur/Fortran/MotsReserves.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\LOGO\INSTR.SQL','CHANTAL:/Compilateur/Logo/Instruction.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\LOGO\FUNC.SQL','CHANTAL:/Compilateur/Logo/Fonction.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\PASCAL\MAINWORD.SQL','CHANTAL:/Compilateur/Pascal/MotsReserves.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\SQL\MAINWORD.SQL','CHANTAL:/Compilateur/SQL/MotsReserves.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\COMPILER\FILES.SQL','CHANTAL:/Compilateur/Extensior.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\CONVERS\FILES.SQL','CHANTAL:/Conversion/Pascal/Extensior.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\DRAW\ELECTRIC.SQL','CHANTAL:/Dessin/PieceElectronique.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\DOS\PROMPT.SQL','CHANTAL:/DOS/Prompt.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\DOS\LOCALEXE.SQL','CHANTAL:/DOS/LocalExecutable.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\DOS\DRDOSVER.SQL','CHANTAL:/DOS/DRDOSVersion.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\UNIX\SHELL.SQL','CHANTAL:/UNIX/Shell.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\VAX\DCL.SQL','CHANTAL:/VAX/DCL.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\FONT\INDEXFNT.SQL','CHANTAL:/Polices/IndexFont.Dat');
 AddFile('\SOURCE\CHANTAL\RESOURCE\HARDWARE\MODEM.SQL','CHANTAL:/Modem/Index.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\MODEMREG.SQL','CHANTAL:/Modem/Registers.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\MODEM\PROTOCOL.SQL','CHANTAL:/Modem/Protocol.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\SYSTEM\DATE.SQL','CHANTAL:/Systeme/Date.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\SYSTEM\LANGUES.SQL','CHANTAL:/Systeme/Langues.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\SYSTEM\ERREUR.SQL','CHANTAL:/Systeme/Erreur.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\APPS\LIST.SQL','CHANTAL:/Application/List.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\APPS\ACTION.SQL','CHANTAL:/Application/Action.Dat');
 Add('\SOURCE\CHANTAL\RESOURCE\GAME\SOKOBAN.SQL','CHANTAL:/Jeux/TableauSokoBan.Dat');
{ Add('\SOURCE\CHANTAL\RESOURCE\HARDWARE\VIDEOMOD.SQL','CHANTAL:/Materiel/VideoMode.Dat');}
 DBDone(Q);
END.
